 :    ********************************* :    *                               * :    * FILE :UADE07                  * :    *                               * :    * PROGRAM :BBC TELESOFT DECODER * :    *                               * :    * DISK :4 LINE DEC              * :    *                               * :    * AUTHOR :MEL                   * :    *                               * :    * DATE CREATED :16/10/81        * :    *                               * :    * DATE CHANGED :9/1/82          * :    *                               * :    * CONTENTS :STACLR              * :    *           STASTR              * :    *           DISPAG              * :    ********************************* : : :   THIS SECTION CONTAINS THE ROUTINES :   TO MANAGE THE SINGLE ROW AVAILABLE :   FOR MESSAGES AT THE BOTTOM OF THE VDU : : : :   FIRST THE DATA AREAS USED BY THE :     ROUTINES : : :STACUR * PARAM +19 :STRPOS * PARAM +1B   (AND 1C) : : :    STACLR CLEARS THE ROW 24 AND RESETS :    THE CURRENT CURSOR POINTER : :STACLR LDYIM $28  PREPARE TO CLEAR : LDAIM $C0   THE LAST ROW BACKWARDS : STAZ STACUR   SET LAST ROW EXPLICITLY : LDAIM $7F     CHANGED FOR PROTON : STAZ STACUR +01 : LDAIM $20     LOAD THE SPACE CHARACTER :SCLOOP DEY : STAIY STACUR   LOAD A BYTE : BNE SCLOOP : RTS        AND EXIT : :   (END OF STACLR : : : :    STASTR  LOAD  A STRING ONTO THE :     BOTTOM ROW OF THE SCREEN : : :STASTR TYA   PREPARE FOR THE SAVE : PHA    SAVE THE COUNT : DEY   ADJUST COUNT : :STSTST LDAIY STRPOS   PICK A BYTE : STAIY STACUR : DEY : BNE STSTST : LDAIY STRPOS   LOAD THE ZERO'TH : STAIY STACUR   BYTE OUTSIDE LOOP : : PLA    NOW RETRIEVE THE COUNT : CLC    AND UPDATE THE CURRENT : ADC STACUR   CURSOR POSITION : STAZ STACUR : LDAIM $00 : ADC STACUR +01 : STA STACUR +01 : RTS : :   (END OF STASTR : : : : :    DISPLAY PAGE NUMBER :    THIS TAKES THE PAGE NUMBER :    AT THE TOP OF THE SCREEN , ADDS :    TO THE END OF THE CURRENT MESSAGE :    AND TERMINATES WITH A <CR> :    THIS IS FOR A FILE NAME ! : : :DISPAG LDYIM $03   ADD FOUR CHARAS : LDAIM $0D   INCLUDING <CR> : STAIY STACUR  TO THE END OF CURRENT : DEY   MESSAGE :DSPLP LDAAY SCRST   PICK UP THE NUMBER : STAIY STACUR   AT THE TOP OF THE SCREEN : DEY : BNE DSPLP : LDAAY SCRST    LAST BYTE TRANSFERRED : STAIY STACUR : RTS : : :   (END OF DISPAG : : :  :HELP LDAIM $0C : JSR OSWRCH : LDAIM HELPST : STA CUROUT : LDAIM HELPST / : STA CUROUT +01 : LDYIM $00 :PSTRNA INC CUROUT : BNE PSTRNB : INC CUROUT +01 :PSTRNB LDAIY CUROUT : CMPIM $04  Ctrl-D =end of file : BEQ PSTRNC : JSR OSASCI : JMP PSTRNA :PSTRNC RTS :  : : : :      NOW THE MESSAGES : : :NORMEL = $10  THE NORMAL DECODER :NORMES = 'S : = 't : = 'a : = 'n : = 'd : = 'a : = 'r : = 'd : = '  : = 'd : = 'e : = 'c : = 'o : = 'd : = 'e : = 'r : : :NORMOD JSR STACLR   CLEAR THE ROW FIRST : LDAIM NORMES : STAZ STRPOS : LDAIM NORMES / : STAZ STRPOS +01 : LDY NORMEL : JSR STASTR : RTS : : :BDEMEL = $19 :BDEMES = $02   Green : = $08   Flashing : = 'B : = 'B : = 'C : = '  : = 'f : = 'o : = 'r : = 'm : = 'a : = 't : = '  : = 't : = 'e : = 'l : = 'e : = 's : = 'o : = 'f : = 't : = 'w : = 'a : = 'r : = 'e : : :BDEMOD JSR STACLR : LDAIM BDEMES : STAZ STRPOS : LDAIM BDEMES / : STAZ STRPOS +01 : LDY BDEMEL : JSR STASTR : RTS : : :CDEMEL = $04 :CDEMES = 'G : = 'u : = 'l : = 'p : :CDEMOD JSR STACLR : LDAIM CDEMES : STAZ STRPOS : LDAIM CDEMES / : STAZ STRPOS +01 : LDY CDEMEL : JSR STASTR : RTS : : :PSEMEL = $11 :PSEMES = 'S : = 'a : = 'v : = 'e : = '  : = 'p : = 'a : = 'g : = 'e : = '  : = 'a : = 's : = '  : = 'T : = 'T : = 'X : = 'T : :PSEMOD JSR STACLR : LDAIM PSEMES : STAZ STRPOS : LDAIM PSEMES / : STAZ STRPOS +01 : LDY PSEMEL : JSR STASTR : RTS : : :PREMEL = $19 :PREMES = 'R : = 'e : = 't : = 'r : = 'i : = 'e : = 'v : = 'e : = '  : = 'f : = 'i : = 'l : = 'e : = '  : = 'c : = 'a : = 'l : = 'l : = 'e : = 'd : = '  : = 'T : = 'T : = 'X : = 'T : :PREMOD JSR STACLR : LDAIM PREMES : STAZ STRPOS : LDAIM PREMES / : STAZ STRPOS +01 : LDY PREMEL : JSR STASTR : RTS :  : :